<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TrashIA – Upload tester</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; }
    #result { margin-top: 2rem; }
    img.preview { max-width: 100%; height: auto; display: block; margin-bottom: 1rem; }
    table { border-collapse: collapse; }
    td, th { border: 1px solid #ccc; padding: 4px 8px; }
  </style>
</head>
<body>

<h1>Trash&nbsp;IA — quick test</h1>

<form id="uploadForm">
  <input type="file" name="image" id="fileInput" accept="image/*" required />
  <button type="submit">Upload</button>
</form>

<div id="result"></div>

<script>
  document.getElementById("uploadForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const fileInput = document.getElementById("fileInput");
    if (!fileInput.files.length) return;

    const formData = new FormData();
    formData.append("image", fileInput.files[0]);

    try {
      const r = await fetch("/upload", { method: "POST", body: formData });
      if (!r.ok) throw new Error(`Server responded ${r.status}`);
      const data = await r.json();

      // Build a little result block
      const resultDiv = document.getElementById("result");
      if (!data.success) {
        resultDiv.textContent = "Upload failed.";
        return;
      }

      const { imageUrl, features } = data;

      resultDiv.innerHTML =
              `<img class="preview" src="${imageUrl}" alt="Uploaded image" />
       <table>
         <tbody>
           ${Object.entries(features).map(
                      ([k, v]) => `<tr><th>${k}</th><td>${v}</td></tr>`
              ).join("")}
         </tbody>
       </table>`;
    } catch (err) {
      alert("Error: " + err.message);
      console.error(err);
    }
  });
</script>

</body>
</html>
